{% extends "page-twocol.html" %}
{% load kegweblib %}
{% load humanize %}

{% block title %}{{ session.GetTitle }} | {{ block.super}}{% endblock %}
{% block pagetitle %}{{ session.GetTitle }}{% endblock %}

{% block col-1 %}

{% with session.events.timeline as events %}
{% include 'kegweb/includes/timeline.html' %}
{% endwith %}

{% endblock col-1 %}



{% block col-2 %}
{% chart users_by_volume stats 350 250 %}

<table class="table table-condensed">
  <tbody>
    <tr>
      <th>When</th>
      <td>
        {{session.start_time}}
      </td>
    </tr>

    {% with session.keg_chunks.all as keg_chunks %}
    <tr>
      <th>Keg{{keg_chunks.count|pluralize}}</th>
      <td>
        {% for chunk in keg_chunks %}
          {% if chunk.keg %}
            <a href="{% url "kb-keg" chunk.keg.id %}">Keg #{{ chunk.keg.id }} ({{ chunk.keg.type }})</a><br>
          {% endif %}
        {% endfor %}
      </td>
    </tr>
    {% endwith %}

    <tr>
      <th>Total</th>
      <td>
        {{ session.drinks.count }} pours,
        {% volume session.volume_ml %}
      </td>
    </tr>

    <tr>
      <th>Drinkers</th>
      <td>
        {{ stats.registered_drinkers|length }}
        drinker{{ stats.registered_drinkers|length|pluralize }}
      </td>
    </tr>

    {% for chunk in session.UserChunksByVolume %}
    <tr>
      <th>{% drinker_name chunk.user nolink %}</th>
      <td>{% volume chunk.volume_ml %}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock col-2 %}
